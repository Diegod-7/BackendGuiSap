{
  "$meta": {
    "tcode": "KSB1",
    "description": "Aplica filtros, gestiona layouts y descarga el ALV (Cost Centers)."
  },
  "targetContext": {
	"SCAREA": "Set Controlling Area",
    "KSCLI": "Display Actual Cost Line Items for Cost Centers : Initial Screen",
    "KSCLO": "Display Actual Cost Line Items for Cost Centers",
    "CHLYT": "Choose Layout",
    "CHNLY": "Change Layout",
    "SELSS": "Select Spreadsheet"
  },
  "steps": {
	"SCAREA": {
		"waitPopup": {
			"action": "waitFor",
			"target": "Set Controlling Area",
			"timeout": "5s",
			"next": "setControllingArea"
		},
		"setControllingArea": {
			"action": "set",
			"target": "Controlling Area",
			"next": "acceptPopup"
		},
		"acceptPopup": {
			"action": "click",
			"target": "Continue   (Enter)",
			"next": "KSCLI.waitScreen"
		}
	},	  
    "KSCLI": {
      "waitScreen": {
        "action": "waitFor",
        "target": "Controlling Area",
        "timeout": "5s",
        "next": "setControllingArea"
      },
      "setControllingArea": {
        "action": "set",
        "target": "Controlling Area",
        "next": "setCostCenterLow"
      },
      "setCostCenterLow": {
        "action": "set",
        "target": "CostCenterLow",
        "next": "setCostCenterHigh"
      },
      "setCostCenterHigh": {
        "action": "set",
        "target": "CostCenterHigh",
        "next": "setCostCenterGroup"
      },
      "setCostCenterGroup": {
        "action": "set",
        "target": "CostCenterGroup",
        "next": "setCostElementLow"
      },
      "setCostElementLow": {
        "action": "set",
        "target": "CostElementLOW",
        "next": "setCostElementHigh"
      },
      "setCostElementHigh": {
        "action": "set",
        "target": "CostElementHIGH",
        "next": "setCostElementGroup"
      },
      "setCostElementGroup": {
        "action": "set",
        "target": "CostElementGroup",
        "next": "setPostingDateLow"
      },
      "setPostingDateLow": {
        "action": "set",
        "target": "PostingDateLow",
        "next": "setPostingDateHigh"
      },
      "setPostingDateHigh": {
        "action": "set",
        "target": "PostingDateHigh",
        "next": "setLayout"
      },
      "setLayout": {
        "action": "set",
        "target": "Layout",
        "next": "setVariantName"
      },
      "setVariantName": {
        "action": "set",
        "target": "VariantName",
        "next": "execute"
      },
      "execute": {
        "action": "click",
        "target": "Execute   (F8)",
        "next": "KSCLO.waitGrid"
      }
    },

    "KSCLO::1": {
      "waitGrid": {
        "action": "waitFor",
        "target": "/app/con[0]/ses[0]/wnd[0]/usr/cntlGRID1/shellcont/shell/shellcont[1]/shell",
        "timeout": "5s",
        "next": "layoutNeeded?"
      },
      "layoutNeeded?": {
        "action": "condition",
        "paramKey": "HasLayout",
        "operator": "==",
        "value": true,
        "true": "openChooseLayout",
        "false": "columnsNeeded?"
      },
      "openChooseLayout": {
        "action": "click",
        "target": "Select Layout...   (Ctrl+F9)",
        "next": "CHLYT.typeLayoutName"
      },
      "columnsNeeded?": {
        "action": "condition",
        "paramKey": "Columns",
        "operator": "exists",
        "true": "openChangeLayout",
        "false": "download"
      },
      "openChangeLayout": {
        "action": "click",
        "target": "Change Layout...   (Ctrl+F8)",
        "next": "CHNLY.waitCL"
      },
      "download": {
        "action": "click",
        "target": "Spreadsheet...   (Ctrl+Shift+F7)",
        "next": "SELSS.waitDialog"
      }
    },

    "CHLYT": {
      "typeLayoutName": {
        "action": "set",
        "target": "cmbG51_SCREEN-USPEC_LBOX",
        "next": "confirmChooseLayout"
      },
      "confirmChooseLayout": {
        "action": "click",
        "target": "Adopt   (Enter)",
        "next": "KSCLO.columnsNeeded?"
      }
    },

    "CHNLY": {
      "waitCL": {
        "action": "waitFor",
        "target": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER1_LAYO/shellcont/shell",
        "timeout": "5s",
        "next": "arrangeColumns"
      },
      "arrangeColumns": {
        "action": "columns",
        "paramKey": "Columns",
        "targetMap": {
          "left": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER2_LAYO/shellcont/shell",
          "right": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER1_LAYO/shellcont/shell",
          "l2r": "Hide selected fields (F6)",
          "r2l": "Show selected fields (F7)"
        },
        "next": "toggleSum"
      },
      "toggleSum": {
        "action": "columnsSum",
        "paramKey": "NoSum",
        "operator": "off",
        "target": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER1_LAYO/shellcont/shell",
        "next": "adoptChangeLayout"
      },
      "adoptChangeLayout": {
        "action": "click",
        "target": "Adopt   (Enter)",
        "next": "KSCLO.download"
      }
    },

    "SELSS": {
      "waitDialog": {
        "action": "waitFor",
        "target": "Select Spreadsheet",
        "timeout": "3s",
        "next": "pressContinue"
      },
      "pressContinue": {
        "action": "click",
        "target": "Continue   (Enter)",
        "next": "handleSaveAs"
      },
      "handleSaveAs": {
        "action": "saveas",
        "timeout": "15s",
        "next": "resetSAP.main"
      }
    },

    "resetSAP": {
      "main": {
        "action": "reset"
      }
    }  }
}