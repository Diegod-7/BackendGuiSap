{
    "$meta": {
        "tcode": "KOB1",
        "description": "Aplica filtros, gestiona layouts y descarga el ALV."
    },
    "targetContext": {
        "SCAREA": "Set Controlling Area",
        "DACLI": "Display Actual Cost Line Items for Orders : Initial Screen",
        "DACLO": "Display Actual Cost Line Items for Orders",
        "CHLYT": "Choose Layout",
        "CHNLY": "Change Layout",
        "SELSS": "Select Spreadsheet"
    },
    "steps": {
        "SCAREA": {
            "waitPopup": {
                "action": "waitFor",
                "target": "Set Controlling Area",
                "timeout": "5s",
                "next": "setControllingArea"
            },
            "setControllingArea": {
                "action": "set",
                "target": "Controlling Area",
                "next": "acceptPopup"
            },
            "acceptPopup": {
                "action": "click",
                "target": "Continue   (Enter)",
                "next": "DACLI.waitVariant"
            }
        },
        "DACLI": {
            "waitVariant": {
                "action": "waitFor",
                "target": "Order Group",
                "timeout": "5s",
                "next": "setCCOR104"
            },
            "setCCOR104": {
                "action": "set",
                "target": "txt%CCOR104_1000",
                "next": "setCCOR043"
            },
            "setCCOR043": {
                "action": "set",
                "target": "txt%CCOR043_1000",
                "next": "setVariantName"
            },
            "setVariantName": {
                "action": "set",
                "target": "txtVARNAME",
                "next": "setOrderGroup"
            },
            "setOrderGroup": {
                "action": "set",
                "target": "Order Group",
                "next": "setCostElementGroup"
            },
            "setCostElementGroup": {
                "action": "set",
                "target": "Cost Element Group",
                "next": "setLayout"
            },
            "setLayout": {
                "action": "set",
                "target": "Layout",
                "next": "setOrderLow"
            },
            "setOrderLow": {
                "action": "set",
                "target": "OrderLow",
                "next": "setOrderHigh"
            },
            "setOrderHigh": {
                "action": "set",
                "target": "OrderHigh",
                "next": "setCostLow"
            },
            "setCostLow": {
                "action": "set",
                "target": "Cost Element",
                "next": "setCostHigh"
            },
            "setCostHigh": {
                "action": "set",
                "target": "Cost Element",
                "next": "setDateLow"
            },
            "setDateLow": {
                "action": "set",
                "target": "Posting Date LOW",
                "next": "setDateHigh"
            },
            "setDateHigh": {
                "action": "set",
                "target": "Posting Date HIGH",
                "next": "execute"
            },
            "execute": {
                "action": "click",
                "target": "Execute   (F8)",
                "next": "DACLO.waitGrid"
            }
        },
        "DACLO::1": {
            "waitGrid": {
                "action": "waitFor",
                "target": "gridResul",
                "timeout": "5s",
                "next": "layoutNeeded?"
            },
            "layoutNeeded?": {
                "action": "condition",
                "paramKey": "HasLayout",
                "operator": "==",
                "value": true,
                "true": "openChooseLayout",
                "false": "columnsNeeded?"
            },
            "openChooseLayout": {
                "action": "click",
                "target": "Select Layout...   (Ctrl+F9)",
                "next": "CHLYT.typeLayoutName"
            },
            "columnsNeeded?": {
                "action": "condition",
                "paramKey": "Columns",
                "operator": "exists",
                "true": "openChangeLayout",
                "false": "download"
            },
            "openChangeLayout": {
                "action": "click",
                "target": "Change Layout...   (Ctrl+F8)",
                "next": "CHNLY.waitCL"
            },
            "download": {
                "action": "click",
                "target": "Spreadsheet...   (Ctrl+Shift+F7)",
                "next": "SELSS.waitDialog"
            }
        },
        "CHLYT": {
            "typeLayoutName": {
                "action": "set",
                "target": "cmbG51_SCREEN-USPEC_LBOX",
                "next": "confirmChooseLayout"
            },
            "confirmChooseLayout": {
                "action": "click",
                "target": "Adopt   (Enter)",
                "next": "DACLO.columnsNeeded?"
            }
        },
        "CHNLY": {
            "waitCL": {
                "action": "waitFor",
                "target": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620",
                "timeout": "5s",
                "next": "arrangeColumns"
            },
            "arrangeColumns": {
                "action": "columns",
                "paramKey": "Columns",
                "targetMap": {
                    "left": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER2_LAYO/shellcont/shell",					
                    "right": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER1_LAYO/shellcont/shell",
                    "l2r": "Hide selected fields (F6)",
                    "r2l": "Show selected fields (F7)"
                },
                "next": "toggleSum"
            },
            "toggleSum": {
                "action": "columnsSum",
                "paramKey": "NoSum",
                "operator": "off",
                "target": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER2_LAYO/shellcont/shell",
                "next": "adoptChangeLayout"
            },
            "adoptChangeLayout": {
                "action": "click",
                "target": "Adopt   (Enter)",
                "next": "DACLO.download"
            }
        },
        "SELSS": {
            "waitDialog": {
                "action": "waitFor",
                "target": "Select Spreadsheet",
                "timeout": "3s",
                "next": "pressContinue"
            },
            "pressContinue": {
                "action": "click",
                "target": "Continue   (Enter)",
                "next": "handleSaveAs"
            },
            "handleSaveAs": {
                "action": "saveas",
                "timeout": "15s",
                "next": "resetSAP.main"
            }
        },
    "resetSAP": {
      "main": {
        "action": "reset"
      }
    }
    }
}