{
  "steps": {
    "startTransaction": {
      "action":   "callProgram",
      "method":   "sapSession.StartTransaction",
      "paramKey": "Tcode",
      "next":     "waitVariant"
    },
    "waitVariant": {
      "action":  "waitFor",
      "target":  "variant.window",
      "timeout": "30s",
      "next":    "setAlsoSelectSpecialStocks"
    },
    "setAlsoSelectSpecialStocks": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/chkPA_SOND",
      "paramKey": "AlsoSelectSpecialStocks",
      "next":     "setDisplayNegativeStocksOnly"
    },
    "setDisplayNegativeStocksOnly": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/chkNEGATIV",
      "paramKey": "DisplayNegativeStocksOnly",
      "next":     "setDisplayBatchStocks"
    },
    "setDisplayBatchStocks": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/chkXMCHB",
      "paramKey": "DisplayBatchStocks",
      "next":     "setNoZeroStockLines"
    },
    "setNoZeroStockLines": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/chkNOZERO",
      "paramKey": "Nozerostocklines",
      "next":     "setDoNotDisplayValues"
    },
    "setDoNotDisplayValues": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/chkNOVALUES",
      "paramKey": "DoNotDisplayValues",
      "next":     "setLayout"
    },
    "setLayout": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtP_VARI",
      "paramKey": "Layout",
      "next":     "setMaterialLow"
    },
    "setMaterialLow": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtMATNR-LOW",
      "paramKey": "MaterialLow",
      "next":     "setMaterialHigh"
    },
    "setMaterialHigh": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtMATNR-HIGH",
      "paramKey": "MaterialHigh",
      "next":     "setPlantLow"
    },
    "setPlantLow": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtWERKS-LOW",
      "paramKey": "PlantLow",
      "next":     "setPlantHigh"
    },
    "setPlantHigh": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtWERKS-HIGH",
      "paramKey": "PlantHigh",
      "next":     "setStorageLocationLow"
    },
    "setStorageLocationLow": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtLGORT-LOW",
      "paramKey": "StorageLocationLow",
      "next":     "setStorageLocationHigh"
    },
    "setStorageLocationHigh": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtLGORT-HIGH",
      "paramKey": "StorageLocationHigh",
      "next":     "setBatchLow"
    },
    "setBatchLow": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtCHARG-LOW",
      "paramKey": "BatchLow",
      "next":     "setBatchHigh"
    },
    "setBatchHigh": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtCHARG-HIGH",
      "paramKey": "BatchHigh",
      "next":     "setMaterialTypeLow"
    },
    "setMaterialTypeLow": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtMATART-LOW",
      "paramKey": "MaterialTypeLow",
      "next":     "setMaterialTypeHigh"
    },
    "setMaterialTypeHigh": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtMATART-HIGH",
      "paramKey": "MaterialTypeHigh",
      "next":     "setMaterialGroupLow"
    },
    "setMaterialGroupLow": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtMATKLA-LOW",
      "paramKey": "MaterialGroupLow",
      "next":     "setMaterialGroupHigh"
    },
    "setMaterialGroupHigh": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtMATKLA-HIGH",
      "paramKey": "MaterialGroupHigh",
      "next":     "setPurchasingGroupLow"
    },
    "setPurchasingGroupLow": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtEKGRUP-LOW",
      "paramKey": "PurchasingGroupLow",
      "next":     "setPurchasingGroupHigh"
    },
    "setPurchasingGroupHigh": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtEKGRUP-HIGH",
      "paramKey": "PurchasingGroupHigh",
      "next":     "setSpecialStockIndicatorLow"
    },
    "setSpecialStockIndicatorLow": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtSO_SOBKZ-LOW",
      "paramKey": "SpecialStockIndicatorLow",
      "next":     "setSpecialStockIndicatorHigh"
    },
    "setSpecialStockIndicatorHigh": {
      "action":   "set",
      "target":   "/app/con[0]/ses[0]/wnd[0]/usr/ctxtSO_SOBKZ-HIGH",
      "paramKey": "SpecialStockIndicatorHigh",
      "next":     "clickExecute"
    },
    "clickExecute": {
      "action": "click",
      "target": "variant.execBtn",
      "next":   "waitProcessing"
    },
    "waitProcessing": {
      "action":  "waitFor",
      "target":  "processing",
      "timeout": "60s",
      "next":    "checkError"
    },
    "checkError": {
      "action":   "condition",
      "target":   "errorDialog",
      "operator": "exists",
      "true":     "notifyErr",
      "false":    "handleLayout"
    },
    "notifyErr": {
      "action":   "notify",
      "paramKey": "ErrorMessage",
      "next":     "end"
    },
    "handleLayout": {
      "action":    "condition",
      "paramKey":  "HasLayout",
      "operator":  "==",
      "value":     true,
      "true":      "chooseLayout",
      "false":     "exportToExcel"
    },
    "chooseLayout": {
      "action": "click",
      "target": "chooseLayout.btn",
      "next":   "setLayoutName"
    },
    "setLayoutName": {
      "action":   "set",
      "target":   "chooseLayout.table",
      "paramKey": "LayoutName",
      "next":     "confirmLayout"
    },
    "confirmLayout": {
      "action": "click",
      "target": "chooseLayout.confirm",
      "next":   "changeLayout"
    },
    "changeLayout": {
      "action": "click",
      "target": "changeLayout.btn",
      "next":   "adoptLayout"
    },
    "adoptLayout": {
      "action": "click",
      "target": "changeLayout.adopt",
      "next":   "exportToExcel"
    },
    "exportToExcel": {
      "action": "click",
      "target": "wnd[0]/tbar[1]/btn[43]",
      "next":   "end"
    },
    "end": {
      "action": "exit"
    }
  }
}