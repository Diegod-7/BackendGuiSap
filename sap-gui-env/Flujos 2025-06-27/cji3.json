{
  "$meta": {
    "tcode": "CJI3",
    "description": "Aplica filtros, gestiona layouts y descarga el ALV."
  },
  "targetContext": {
    "SCAREA": {
      "FriendlyName": "Set Controlling Area",
      "deepaliases": {
        "Set Controlling Area": "/app/con[0]/ses[0]/wnd[1]",
        "Controlling Area": "/app/con[0]/ses[0]/wnd[1]/usr/sub:SAPLSPO4:0300/ctxtSVALD-VALUE[0,21]",
        "Continue   (Enter)": "/app/con[0]/ses[0]/wnd[1]/tbar[0]/btn[0]"
      }
    },
    "ENTPR": {
      "FriendlyName": "Enter profile",
      "deepaliases": {
        "Enter profile": "/app/con[0]/ses[0]/wnd[1]",
        "Database prof.": "/app/con[0]/ses[0]/wnd[1]/usr/ctxtTCNT-PROF_DB",
        "Continue   (Enter)": "/app/con[0]/ses[0]/wnd[1]/tbar[0]/btn[0]"
      }
    },
    "DPCLI": {
      "FriendlyName": "Display Project Actual Cost Line Items",
      "deepaliases": {
        "ProjectLow": "/app/con[0]/ses[0]/wnd[0]/usr/ctxtCN_PROJN-LOW",
        "ProjectHigh": "/app/con[0]/ses[0]/wnd[0]/usr/ctxtCN_PROJN-HIGH",
        "WBS Element Low": "/app/con[0]/ses[0]/wnd[0]/usr/ctxtCN_PSPNR-LOW",
        "WBS Element High": "/app/con[0]/ses[0]/wnd[0]/usr/ctxtCN_PSPNR-HIGH",
        "Network/order Low": "/app/con[0]/ses[0]/wnd[0]/usr/ctxtCN_NETNR-LOW",
        "Network/order High": "/app/con[0]/ses[0]/wnd[0]/usr/ctxtCN_NETNR-HIGH",
        "Cost Element": "/app/con[0]/ses[0]/wnd[0]/usr/ctxtR_KSTAR-LOW",
        "Posting date LOW": "/app/con[0]/ses[0]/wnd[0]/usr/ctxtR_BUDAT-LOW",
        "Posting date HIGH": "/app/con[0]/ses[0]/wnd[0]/usr/ctxtR_BUDAT-HIGH",
        "Layout": "/app/con[0]/ses[0]/wnd[0]/usr/ctxtP_DISVAR"
      }
    },
    "DPCLO": {
      "FriendlyName": "Display Actual Cost Line Items for Projects",
      "deepaliases": {
        "gridResul": "/app/con[0]/ses[0]/wnd[0]/usr/cntlGRID1/shellcont/shell/shellcont[0]/shell",
        "export": "Spreadsheet...   (Ctrl+Shift+F7)",
        "selectLayout": "Select Layout...   (Ctrl+F9)",
        "changeLayout": "Change Layout...   (Ctrl+F8)"
      }
    },
    "CHLYT": "Choose Layout",
    "CHNLY": {
      "FriendlyName": "Change Layout",
      "targetMap": {
        "left": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER2_LAYO/shellcont/shell",
        "right": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER1_LAYO/shellcont/shell",
        "l2r": "Hide selected fields (F6)",
        "r2l": "Show selected fields (F7)"
      }
    },
    "SELSS": "Select Spreadsheet"
  },
  "steps": {
    "SCAREA": {
      "waitPopup": {
        "action": "waitFor",
        "target": "Set Controlling Area",
        "timeout": "5s",
        "next": "setControllingArea"
      },
      "setControllingArea": {
        "action": "set",
        "target": "Controlling Area",
        "next": "acceptPopup"
      },
      "acceptPopup": {
        "action": "click",
        "target": "Continue   (Enter)",
        "next": "ENTPR.waitPopup"
      }
    },
    "ENTPR": {
      "waitPopup": {
        "action": "waitFor",
        "target": "Enter profile",
        "timeout": "5s",
        "next": "setDBProfile"
      },
      "setDBProfile": {
        "action": "set",
        "target": "Database prof.",
        "next": "acceptProfile"
      },
      "acceptProfile": {
        "action": "click",
        "target": "Continue   (Enter)",
        "next": "DPCLI.waitVariant"
      }
    },
    "DPCLI": {
      "waitVariant": {
        "action": "waitFor",
        "target": "Project",
        "timeout": "5s",
        "next": "setVariantName"
      },
      "setVariantName": {
        "action": "set",
        "target": "txtVARNAME",
        "next": "setProjectLow"
      },
      "setProjectLow": {
        "action": "set",
        "target": "ProjectLow",
        "next": "setProjectHigh"
      },
      "setProjectHigh": {
        "action": "set",
        "target": "ProjectHigh",
        "next": "setWBSLow"
      },
      "setWBSLow": {
        "action": "set",
        "target": "WBS Element Low",
        "next": "setWBSHigh"
      },
      "setWBSHigh": {
        "action": "set",
        "target": "WBS Element High",
        "next": "setNetworkLow"
      },
      "setNetworkLow": {
        "action": "set",
        "target": "Network/order Low",
        "next": "setNetworkHigh"
      },
      "setNetworkHigh": {
        "action": "set",
        "target": "Network/order High",
        "next": "setCostElementGroup"
      },
      "setCostElementGroup": {
        "action": "set",
        "target": "Cost Element Group",
        "next": "setCostLow"
      },
      "setCostLow": {
        "action": "set",
        "target": "Cost Element",
        "next": "setCostHigh"
      },
      "setCostHigh": {
        "action": "set",
        "target": "Cost Element",
        "next": "setDateLow"
      },
      "setDateLow": {
        "action": "set",
        "target": "Posting date LOW",
        "next": "setDateHigh"
      },
      "setDateHigh": {
        "action": "set",
        "target": "Posting date HIGH",
        "next": "setLayout"
      },
      "setLayout": {
        "action": "set",
        "target": "Layout",
        "next": "execute"
      },
      "execute": {
        "action": "click",
        "target": "Execute   (F8)",
        "next": "DPCLO.waitGrid"
      }
    },
    "DPCLO::1": {
      "waitGrid": {
        "action": "waitFor",
        "target": "gridResul",
        "timeout": "5s",
        "next": "layoutNeeded?"
      },
      "layoutNeeded?": {
        "action": "condition",
        "paramKey": "HasLayout",
        "operator": "==",
        "value": true,
        "true": "openChooseLayout",
        "false": "columnsNeeded?"
      },
      "openChooseLayout": {
        "action": "click",
        "target": "Select Layout...   (Ctrl+F9)",
        "next": "CHLYT.typeLayoutName"
      },
      "columnsNeeded?": {
        "action": "condition",
        "paramKey": "Columns",
        "operator": "exists",
        "true": "openChangeLayout",
        "false": "download"
      },
      "openChangeLayout": {
        "action": "click",
        "target": "Change Layout...   (Ctrl+F8)",
        "next": "CHNLY.waitCL"
      },
      "download": {
        "action": "click",
        "target": "Spreadsheet...   (Ctrl+Shift+F7)",
        "next": "SELSS.waitDialog"
      }
    },
    "CHLYT": {
      "typeLayoutName": {
        "action": "set",
        "target": "cmbG51_SCREEN-USPEC_LBOX",
        "next": "confirmChooseLayout"
      },
      "confirmChooseLayout": {
        "action": "click",
        "target": "Adopt   (Enter)",
        "next": "DPCLO.columnsNeeded?"
      }
    },
    "CHNLY": {
      "waitCL": {
        "action": "waitFor",
        "target": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER1_LAYO/shellcont/shell",
        "timeout": "5s",
        "next": "arrangeColumns"
      },
      "arrangeColumns": {
        "action": "columns",
        "paramKey": "Columns",
        "targetMap": {
          "left": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER2_LAYO/shellcont/shell",
          "right": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER1_LAYO/shellcont/shell",
          "l2r": "Hide selected fields (F6)",
          "r2l": "Show selected fields (F7)"
        },
        "next": "toggleSum"
      },
      "toggleSum": {
        "action": "columnsSum",
        "paramKey": "NoSum",
        "operator": "off",
        "target": "/app/con[0]/ses[0]/wnd[1]/usr/tabsG_TS_ALV/tabpALV_M_R1/ssubSUB_CONFIGURATION:SAPLSALV_CUL_COLUMN_SELECTION:0620/cntlCONTAINER1_LAYO/shellcont/shell",
        "next": "adoptChangeLayout"
      },
      "adoptChangeLayout": {
        "action": "click",
        "target": "Adopt   (Enter)",
        "next": "DPCLO.download"
      }
    },
    "SELSS": {
      "waitDialog": {
        "action": "waitFor",
        "target": "Select Spreadsheet",
        "timeout": "3s",
        "next": "pressContinue"
      },
      "pressContinue": {
        "action": "click",
        "target": "Continue   (Enter)",
        "next": "handleSaveAs"
      },
      "handleSaveAs": {
        "action": "saveas",
        "timeout": "15s",
        "next": "resetSAP.main"
      }
    },
    "resetSAP": {
      "main": {
        "action": "reset"
      }
    }
  }
}